#### 3.2.27.单据审批

##### 3.2.27.1 特性描述

总经理可以在登录后，对所有提交的单据进行审批。

优先级=高

##### 3.2.27.2 刺激/响应序列

刺激：用户选择单据审批功能。

响应：系统按照提交顺序列表显示所有处于等待审批状态的单据。

刺激：用户全选单据。

响应：系统选中所有单据，显示勾选所有复选框。

刺激：用户选择多张单据并点击**通过**按钮。

响应：系统将单据状态设置为已入账，根据单据内容修改库存数据和客户应收应付数据，并将批量审批操作记录在日志中。

刺激：用户点击某张单据进行查看。

响应：系统列出单据的具体内容。

刺激：用户点击**通过**按钮，通过该单据的审批。

响应：系统提示操作成功，将单据状态设置为已入账，根据单据内容修改库存数据和客户应收应付数据，并将通过单据审批操作记录在日志中。

刺激：用户拒绝通过审批。

响应：系统提示填写拒绝理由。

刺激：用户填写拒绝理由并提交。

响应：系统提示是否确认提交。

刺激：用户放弃提交。

响应：系统回到填写拒绝理由界面。

刺激：用户确认提交。

响应：系统提示提交成功，发送消息给操作员，将单据状态设置为未通过审批，并将拒绝审批操作记录在日志中。

##### 3.2.27.3 相关功能需求

| 编号         | 需求描述与度量                                  |
| ---------- | ---------------------------------------- |
| Audit.Show | 当用户请求审批单据的时候，系统应按照提交顺序列表显示出所有处于等待审批状态的单据（**输出**） |

| 编号                                   | 需求描述与度量                                  |
| ------------------------------------ | ---------------------------------------- |
| Audit.Multipass                      | 当用户需要批量审批单据时，系统应该允许用户进行鼠标点击操作，参见Audit.Multipass.Choose |
| Audit.Multipass.Choose               | 当用户勾选某个复选框时，系统记录选择的单据（**逻辑文件**）          |
| Audit.Multipass.Choose.Checkall      | 当用户全选单据（**查询**）时，系统选中所有单据，显示勾选所有的复选框（**逻辑文件**） |
| Audit.Multipass.Choose.Cancel        | 当用户取消选择的多个单据时，系统撤销选中的复选框（**逻辑文件**）       |
| Audit.Multipass.Submit               | 当用户选择多个单据并通过审批时（**查询**）时，系统弹出窗口询问是否全部通过审批（**输出**） |
| Audit.Multipass.Submit.Confirmed     | 用户确认通过（**查询**），系统弹出窗口提示已通过审批（**输出**），将单据状态设置为已入账，根据单据内容修改库存数据和客户应收应付数据（**逻辑文件**），用户确认该提示信息后系统回到单据审批页面 |
| Audit.Multipass.Submit.Confirmed.Log | 当用户批量审批成功时，系统应在操作日志记录批量审批操作（逻辑文件）        |
| Audit.Multipass.Submit.Cancel        | 当用户放弃确认通过审批时，系统应回到单据审批界面                 |

| 编号                                  | 需求描述与度量                                  |
| ----------------------------------- | ---------------------------------------- |
| Audit.Inspect                       | 当用户查看某张单据（**查询**）时，系统应弹出窗口显示该单据的全部内容（**输出**） |
| Audit.Inspect.Back                  | 当用户查看完单据详细信息退出时，系统关闭单据详情界面，回到单据审批界面      |
| Audit.Inspect.Pass                  | 当用户通过该单据审批（**查询**）时，系统弹出窗口提示已通过审批（**输出**），将单据状态设置为已入账，根据单据内容修改库存数据和客户应收应付数据（**逻辑文件**），用户确认该提示信息后系统回到单据审批页面 |
| Audit.Inspect.Log                   | 无论用户通过审批还是拒绝通过审批，系统都应记录相应的操作日志（**逻辑文件**） |
| Audit.Inspect.Rejuct                | 当用户拒绝通过某单据的审批（**查询**）时，系统弹出窗口要求用户填写拒绝通过的理由（**输出**） |
| Audit.Inspect.Rejuct.Reason         | 当用户填写完拒绝通过的理由（**输入**）并点击提交（**查询**）时，系统弹出窗口询问是否确认提交（**输出**） |
| Audit.Inspect.Rejuct.Reason.Confirm | 当用户再次确认时，系统将单据状态设置为未通过审批（**逻辑文件**），并弹出窗口提示已发送消息给相关人员（**输出**），用户确认该提示信息后系统应回到单据审批界面 |
| Audit.Inspect.Rejuct.Reason.Cancel  | 当用户选择放弃（**查询**）时，系统应回到填写拒绝通过理由界面         |


#### 3.2.28.制定促销策略

##### 3.2.28.1 特性描述

总经理可以在登录后，制定不同的促销策略，促进销售。

优先级=中

##### 3.2.28.2 刺激/响应序列

刺激：用户点击制定促销策略按钮。

响应：系统显示6种具体促销策略（组合商品降价、满额赠送代金券、满额赠送礼品、客户赠送代金券、客户赠送礼品、客户价格折让）。

刺激：用户选择其中一种促销策略进行制定。

响应：系统显示相应界面（组合商品降价、满额赠送礼品、客户赠送礼品策略）或要求填写相应策略信息（满额赠代金券需要填写额度、代金券面值、开始日期和结束日期；客户赠代金券需要填写客户级别、代金券面值、开始日期和结束日期；客户价格折让需要填写客户级别、购买总额、折让价格、开始日期和结束日期；）。

刺激：用户输入格式正确的商品标识。

响应：系统显示商品信息（商品标识、描述和价格）。

刺激：用户输入格式不正确的商品标识。

响应：系统提示商品标识格式不正确。

刺激：用户选择该商品作为组合促销商品或者赠品。

响应：系统提示选择成功并记录当前商品。

刺激：用户删除某商品。

响应：系统提示删除成功并更新记录。

刺激：用户完成商品（或赠品）选择。

响应：系统要求填写相应的策略信息（组合商品降价需要填写降价金额、开始日期和结束日期；满额赠品需要填写额度、赠品标识、开始时间和结束时间；客户赠品需要填写客户级别、赠品标识、开始时间和结束时间；）

刺激：用户放弃策略信息填写。

响应：系统保存草稿，回到商品选择界面或者促销策略选择界面。

刺激：用户完成策略信息填写，点击提交。

响应：系统弹出确认窗口。

刺激：用户点击确认。

响应：若该策略与已有策略存在冲突，系统提示与已有策略存在冲突；若无冲突则记录促销策略信息并生成日志。

刺激：用户点击取消。

响应：系统询问用户是否要保存草稿。

刺激：用户保存草稿。

响应：系统保存草稿，记录日志，返回制定促销策略界面。

刺激：用户不保存草稿。

响应：系统丢弃促销策略信息，返回制定促销策略界面。

刺激：系统点击复位按钮。

响应：系统提示用户是否撤销修改。

刺激：用户确认。

响应：系统撤销用户的修改。

刺激：用户不确认。

响应：系统返回。

刺激：用户按下回撤快捷键。

响应：系统回撤刚才的操作。

刺激：用户按下重做快捷键。

响应：系统重做刚才的回做。

刺激：用户删除某促销策略。

响应：若该策略已经生效，系统提示策略已经生效无法删除；若该策略处于等待生效状态则废弃该促销策略并生成日志。

刺激：用户修改等待生效的促销策略。

响应：系统显示相应的促销策略信息填写界面。

刺激：用户修改已经生效或者过期的促销策略。

响应：系统警告用户策略已经生效无法修改。

刺激：用户查看所有的促销策略。

响应：系统按照最后一次修改时间列表显示所有策略。

刺激：用户输入关键字进行促销策略的搜索。

响应：系统显示根据关键字筛选出的结果。

##### 3.2.28.3 相关功能需求

| 编号                    | 需求描述与度量                                  |
| --------------------- | ---------------------------------------- |
| Promotion.Show        | 当用户需要制定促销策略时，系统显示6种不同的促销策略（**输出**）       |
| Promotion.Show.Choose | 当用户选择其中一种促销策略进行制定（**查询**）时，系统显示相应界面（组合商品降价、满额赠送礼品、客户赠送礼品策略）或要求填写相应策略信息（满额赠代金券需要填写额度、代金券面值、开始日期和结束日期；客户赠代金券需要填写客户级别、代金券面值、开始日期和结束日期；客户价格折让需要填写客户级别、购买总额、折让价格、开始日期和结束日期）（**输出**） |

| 编号                                   | 需求描述与度量                                  |
| ------------------------------------ | ---------------------------------------- |
| Promotion.View                       | 当用户点击查看保存的促销策略（**查询**）时，系统按照最后一次修改时间列表显示所有促销策略简要信息（**输出**） |
| Promotion.View.Select                | 当用户选择某一个促销策略进行查看（**查询**）时，系统显示促销策略详细信息（**输出**） |
| Promotion.View.Select.Modify.Valid   | 当用户选择修改等待生效的促销策略（**查询**）时，系统弹出促销策略信息填写页面，并显示保存的信息（**输出**），参见Promotion.Input.Condition.Submit |
| Promotion.View.Select.Modify.Invalid | 当用户选择修改已经生效或者过期的促销策略（**查询**）时，系统弹出窗口警告用户“该促销策略无法修改”（**输出**） |
| Promotion.View.Select.Delete.Valid   | 当用户选择删除等待生效或已过期的促销策略（**查询**）时，系统提出窗口询问是否确认删除（**输出**），参见Promotion.Delete |
| Promotion.View.Select.Delete.Invalid | 当用户选择删除正在生效的促销策略（**查询**）时，系统弹出窗口警告用户该促销策略无法删除（**输出**） |
| Promotion.View.Filtrate              | 当用户输入关键字（**输入**）进行促销策略搜索（**查询**）时，系统按照最后一次修改时间列表显示所有符合条件的促销策略（输出） |

| 编号                               | 需求描述与度量                                  |
| -------------------------------- | ---------------------------------------- |
| Promotion.Input                  | 当用户制定促销策略时，系统应当允许用户进行鼠标点击和键盘输入           |
| Promotion.Input.Product.Valid    | 当用户输入目录中存在的商品标识时，系统应显示商品信息（商品标识、描述和价格）   |
| Promotion.Input.Product.Invalid  | 当用户输入其他标识时，系统应弹出窗口警告用户商品标识格式不正确          |
| Promotion.Input.Condition        | 当用户完成商品选择（**查询**）时，系统弹出窗口要求填写相应的策略信息（组合商品降价需要填写降价金额、开始日期和结束日期；满额赠品需要填写额度、赠品标识、开始时间和结束时间；客户赠品需要填写客户级别、赠品标识、开始时间和结束时间）（**输出**） |
| Promotion.Input.Condition.Cancel | 当用户放弃当前填写的策略信息时（**查询**），系统应弹出窗口询问是否保存草稿（**输出**），参见Promotion.Cancel |
| Promotion.Input.Condition.Submit | 当用户完成促销策略信息的填写（**输入**），需要提交时，参见Promotion.Submit |

| 编号                             | 需求描述与度量                                  |
| ------------------------------ | ---------------------------------------- |
| Promotionl.Cancel.Backup       | 当用户选择保存草稿时（**查询**），系统应保存当前促销策略内容（**逻辑文件**），并返回制定促销策略主界面 |
| Promotion.Cancel.Backup.Failed | 如果系统保存失败，应弹出窗口提示用户保存草稿失败，并显示具体原因（**输出**）。用户确认后，应保留信息，退回填写促销策略信息页面 |
| Promotion.Cancel.Backup.Log    | 当用户确认保存草稿时，无论操作是否成功，系统都应记录日志（**逻辑文件**）   |
| Promotion.Cancel.NoBackup      | 当用户选择不保存草稿时（**查询**），系统应丢弃当前促销策略信息，并返回制定促销策略主界面 |
| Promotion.Cancel.Back          | 当用户取消放弃当前的促销策略信息操作时（**查询**），系统应回到填写促销策略信息页面。 |

| 编号                                     | 需求描述与度量                                  |
| -------------------------------------- | ---------------------------------------- |
| Promotion.Submit.Review                | 当用户提交促销策略信息（**查询**）时，系统给出当前单据的总览（**输出**）让用户复查 |
| Promotion.Submit.Confirmed.Success     | 当用户确认无误（**查询**）时，若系统判断当前促销策略与已有促销策略无冲突（**逻辑文件**），则记录促销策略信息，提出窗口通知用户促销策略制定成功 |
| Promotion.Submit.Confirm.Failure       | 当用户确认无误（**查询**）时，若系统判断当前促销策略与已有促销策略存在冲突（**逻辑文件**），则提出窗口警告用户促销策略存在冲突（**输出**），用户确认该警告后返回促销策略信息填写界面 |
| Promotion.Submit.Confirmed.Success.Log | 当用户提交制定的促销策略成功时，系统记录当前操作在日志中（**逻辑文件**）   |
| Promotion.Submit.Back                  | 当用户需要返回做修改时（**查询**），系统应返回促销策略信息填写页面      |

| 编号                         | 需求描述与度量                                  |
| -------------------------- | ---------------------------------------- |
| Promotion.Reset            | 当用户点击复位按钮的时候（**查询**），系统应弹出窗口询问用户是否要复位全部信息（**输出**）。 |
| Promotionl.Reset.Confirmed | 当用户确认复位填写的促销策略信息时（**查询**），系统应复位当前信息      |
| Promotion.Reset.Back       | 当用户点击返回按钮的时候（**查询**），系统应返回到促销策略信息填写页面让用户继续填写。 |

| 编号             | 需求描述与度量                          |
| -------------- | -------------------------------- |
| Promotion.Undo | 用户按下回撤快捷键（**查询**）时，系统应撤回用户刚才做的修改 |

| 编号             | 需求描述与度量                          |
| -------------- | -------------------------------- |
| Promotion.Redo | 用户按下重做快捷键（**查询**）时，系统应重做用户刚才做的修改 |

| 编号                         | 需求描述与度量                                  |
| -------------------------- | ---------------------------------------- |
| Promotion.Delete.Confirmed | 当用户确认删除促销策略（**查询**）时，系统丢弃该促销策略的信息，将状态设置为已废弃，并在日志中记录删除操作（**逻辑文件**） |
| Promotion.Delete.Cancel    | 当用户取消删除一个等待生效的促销策略的操作（**查询**）时，系统返回到该促销策略的详情页面 |



#### 3.2.29.查看日志

##### 3.2.29.1 特性描述

总经理和财务人员可以在登录后，查看系统主要操作记录。                              

优先级=低

##### 3.2.29.2 刺激/响应序列

刺激：用户查看系统主要操作日志。

响应：系统按照操作时间列表显示主要操作的简要信息（包括时间、操作人员、具体操作名称）。

刺激：用户进行查询。

响应：系统给出需要填写的筛选条件信息（时间、操作人员、具体操作名称）。

刺激：用户填写有效筛选条件进行搜索。

响应：系统列表显示符合条件的操作记录，若无符合条件的记录则弹出窗口提示无符合条件的记录。

刺激：用户填写其他筛选条件进行搜索。

响应：系统弹出窗口警告用户筛选条件无效。

刺激：用户选择**时间段**进行查询。

响应：系统按照操作时间顺序显示所有该时间段内记录的主要操作。

##### 3.2.29.3 相关功能需求

| 编号           | 需求描述与度量                                  |
| ------------ | ---------------------------------------- |
| Viewlog.Show | 当用户查看主要操作日志（**查询**）时，系统按照操作时间列表显示主要操作的简要信息（包括时间、操作人员、具体操作）（**输出**） |

| 编号                             | 需求描述与度量                                  |
| ------------------------------ | ---------------------------------------- |
| Viewlog.Filtrate               | 当用户需要查询特定日志时，系统给出需要填写的筛选条件（时间、操作人员、具体操作名称） |
| Viewlog.Filtrate.Input.Vaild   | 当用户输入的筛选条件（**输入**）合法（时间、操作人员、具体操作名称）（**逻辑文件**）时，系统列表显示符合条件的操作记录，若无符合条件的记录则弹出窗口提示无符合条件的记录（**输出**） |
| Viewlog.Filtrate.Input.Invaild | 当输入其他内容（**逻辑文件**）时，系统警告用户筛选条件无效（**输出**）  |
| Viewlog.Filtrate.Input.Time    | 当用户选择时间段进行搜索时（**查询**），系统显示按操作时间顺序显示该时间段主要操作（**输出**） |



#### 3.2.30 总经理管理草稿箱

##### 3.2.30.1 特性描述

总经理可以在登录后，进入到草稿箱，查看并修改草稿内容。

优先级=中

##### 3.2.30.2 刺激/响应序列

刺激：用户进入草稿箱。

响应：系统按照保存时间列表显示所有促销策略信息的草稿。

刺激：用户查看一条促销策略草稿的信息。

响应：系统显示保存的该促销策略的所有信息。

刺激：用户点击取消按钮。

响应：系统回到草稿箱界面。

刺激：用户选择编辑草稿。

响应：系统尝试读取并删除备份信息，若成功，进入到促销策略信息填写界面，若失败，系统提示错误，用户确认信息后，系统回到**草稿箱**界面

刺激：用户删除选中的草稿。

响应：系统询问是否确认删除，并列表显示草稿的简略信息。

刺激：用户查看需要删除的草稿详情后点击**确认**按钮。

响应：系统返回询问是否确认删除草稿界面

刺激：用户确认删除选中的草稿按钮

响应：系统丢弃该草稿保存的信息，在日志中记录删除草稿操作；

##### 3.2.15.3 相关功能需求

| 编号                             | 需求描述与度量                                  |
| ------------------------------ | ---------------------------------------- |
| ManagerDraftBackup.Show        | 当用户进入草稿箱（**查询**）时，系统按照保存时间列表显示所有促销策略信息的草稿（包括修改时间、促销策略分类）（**输出**） |
| ManagerDraftBackup.Show.Select | 当用户点击一条草稿（**查询**）时，系统显示保存的该促销策略的所有信息，参见ManagerDraftBackup.Detail |
| ManagerDraftBackup.Show.Delete | 当用户删除选中的草稿（**查询**）时，系统弹出窗口询问是否确认删除，并显示选中草稿的简略信息（**输出**），参见ManagerDraftBackup.Delete |



| 编号                                     | 需求描述与度量                                  |
| -------------------------------------- | ---------------------------------------- |
| ManagerDraftBackup.Detail.Cancel       | 当用户取消查看（**查询**）时，系统返回草稿箱界面。              |
| ManagerDraftBackup.Detail.Edit         | 当用户选择编辑（**查询**）时，系统应尝试读取后，删除备份信息（**逻辑文件**）。 |
| ManagerDraftBackup.Detail.Edit.Success | 当用户选择编辑时，若系统成功读取草稿，显示相应促销策略制定界面（**输出**），恢复备份，删除在草稿箱中的草稿（**逻辑文件**），则参见Promotion.Input |
| ManagerDraftBackup.Detail.Edit.Failure | 当用户选择编辑时，若系统在读取备份单据时出现错误，或者读取后删除失败时，系统应弹出窗口提示相应的错误（**输出**），用户确认后系统返回草稿箱界面。 |



| 编号                                       | 需求描述与度量                                  |
| ---------------------------------------- | ---------------------------------------- |
| ManagerDraftBackup.Delete.Detail         | 当用户选择一条备份（**查询**）时，系统弹出窗口显示该备份的详细信息（**输出**） |
| ManagerDraftBackup.Delete.Detail.Back    | 当用户确认草稿详情（**查询**）时，系统返回询问是否确认删除界面。       |
| ManagerDraftBackup.Delete.Confirmed      | 当用户确认删除选中的所有草稿（**查询**）时，系统应删除这些草稿（**逻辑文件**） |
| ManagerDraftBackup.Delete.Confirmed.Success | 如果系统删除成功（**逻辑文件**），则弹出窗口提示删除成功（**输出**），用户确认信息后，系统返回草稿箱界面 |
| ManagerDraftBackup.Delete.Confirmed.Failure | 如果系统删除失败（**逻辑文件**），则弹出窗口提示删除失败（**输出**），用户确认信息后，系统返回草稿箱界面 |
| ManagerDraftBackup.Delete.Confirmed.Log  | 当用户确认删除草稿时，无论操作是否成功，系统都在日志中记录删除操作（**逻辑文件**） |

